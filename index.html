from docx import Document
import html

# Load the Word document again
doc_path = "/mnt/data/BIOREACTOR & FERMENTER REQUIREMENT QUESTIONNAIRE.docx"
doc = Document(doc_path)

# Start HTML with styling and form layout
html_lines = ['<!DOCTYPE html>', '<html>', '<head>', '<meta charset="UTF-8">',
              '<title>Bioreactor & Fermenter Requirement Form</title>',
              '<style>',
              'body { font-family: Arial, sans-serif; padding: 20px; max-width: 1000px; margin: auto; }',
              'h1, h2 { color: #1a5276; }',
              'input[type="text"], textarea { width: 100%; padding: 6px; margin: 6px 0; border: 1px solid #ccc; border-radius: 4px; }',
              'input[type="checkbox"] { border-radius: 50%; width: 18px; height: 18px; appearance: none; border: 2px solid #555; position: relative; margin-right: 6px; vertical-align: middle; }',
              'input[type="checkbox"]:checked::before { content: ""; background-color: #2196F3; display: block; width: 10px; height: 10px; margin: 2px auto; border-radius: 50%; }',
              'label { display: block; margin-top: 8px; font-weight: normal; }',
              'textarea { height: 80px; }',
              'hr { border: 0; border-top: 1px solid #ccc; margin: 20px 0; }',
              '</style>',
              '</head>', '<body>',
              '<h1>BIOREACTOR & FERMENTER REQUIREMENT QUESTIONNAIRE</h1>',
              '<p><em>(For Lab, Pilot, and Production Scale Applications)</em></p>']

# Parse each paragraph
for para in doc.paragraphs:
    text = para.text.strip()
    if not text:
        html_lines.append('<input type="text" placeholder="(Enter text)">')
        continue

    if text.upper().startswith("SECTION"):
        html_lines.append(f'<hr><h2>{html.escape(text)}</h2>')
    elif "☐" in text:
        parts = text.split("☐")
        for part in parts[1:]:
            label = part.strip().strip(":")
            if any(keyword in label for keyword in ["Others", "Custom", "Note"]):
                html_lines.append(f'<label><input type="checkbox">{html.escape(label)} <input type="text" placeholder="Please specify"></label>')
            else:
                html_lines.append(f'<label><input type="checkbox">{html.escape(label)}</label>')
    elif "Note:" in text:
        label = html.escape(text.replace("Note:", "").strip())
        html_lines.append(f'<label>Note: <input type="text" placeholder="{label}"></label>')
    elif ":" in text:
        label, _ = text.split(":", 1)
        html_lines.append(f'<label>{html.escape(label)} <input type="text"></label>')
    else:
        html_lines.append(f'<p>{html.escape(text)}</p>')

# Final note
html_lines.append('<p><strong>Once completed, please export this form as Word/PDF and send to: <a href="mailto:be2d2024@gmail.com">be2d2024@gmail.com</a></strong></p>')
html_lines.append('</body></html>')

# Write HTML to file
html_content = "\n".join(html_lines)
output_file = "/mnt/data/Bioreactor_Fermenter_Requirement_Form.html"
with open(output_file, "w", encoding="utf-8") as f:
    f.write(html_content)

output_file
